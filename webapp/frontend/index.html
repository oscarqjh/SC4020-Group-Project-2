<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medical Analysis AI Portal</title>
    <link rel="stylesheet" href="/assets/styles.css" />
  </head>
  <body>
    <header>
      <h1>Medical Analysis AI Portal</h1>
      <p class="subtitle">Interactive interface for the CrewAI medical analysis system</p>
    </header>

    <main>
      <div class="tab-bar">
        <button class="tab-button active" data-target="chat-tab">Chat Console</button>
        <button class="tab-button" data-target="forms-tab">Guided Forms</button>
      </div>

      <section id="chat-tab" class="tab-content active">
        <article class="instructions">
          <h2>System Instructions</h2>
          <pre id="instructions-text"></pre>
        </article>

        <article class="chat-panel">
          <div id="chat-history" class="chat-history"></div>
          <form id="chat-form">
            <input
              type="text"
              id="chat-input"
              placeholder="Enter your medical query..."
              autocomplete="off"
              required
            />
            <button type="submit">Send</button>
          </form>
        </article>
      </section>

      <section id="forms-tab" class="tab-content">
        <article class="card">
          <h2>Symptom Checklist</h2>
          <p class="helper">
            Select the symptoms you experience. The AI can follow up if it needs more for accuracy.
          </p>
          <div id="symptom-grid" class="symptom-grid"></div>
          <div class="actions">
            <button id="reset-symptoms" class="secondary">Reset</button>
            <button id="run-symptom-analysis">Analyze Symptoms</button>
          </div>
        </article>

        <article class="card">
          <h2>Breast Cancer Measurements</h2>
          <div class="callout-box">
            <div class="callout-icon">ðŸ’¡</div>
            <div class="callout-content">
              <p class="helper">
                Provide the measurements you know. For trained model predictions (instead of heuristic fallback), 
                please include at minimum: <strong>Area (Mean)</strong>, <strong>Area (SE)</strong>, 
                <strong>Concave Points (Mean)</strong>, and <strong>Concave Points (SE)</strong>. 
                Additional fields are optional but help improve accuracy.
              </p>
            </div>
          </div>
          <form id="breast-form" class="breast-form">
            <!-- Recommended Fields (Required) -->
            <div class="field-group">
              <h3 class="field-group-title">Recommended</h3>
              <div class="grid-form" id="recommended-fields">
                <label>
                  Area (Mean)
                  <input type="number" step="0.0000001" name="area_mean" required />
                </label>
                <label>
                  Area (SE)
                  <input type="number" step="0.0000001" name="area_se" required />
                </label>
                <label>
                  Concave Points (Mean)
                  <input type="number" step="0.0000001" name="concave_points_mean" required />
                </label>
                <label>
                  Concave Points (SE)
                  <input type="number" step="0.0000001" name="concave_points_se" required />
                </label>
              </div>
            </div>

            <!-- Additional Fields Dropdown -->
            <div class="field-selector">
              <label class="selector-label">
                Add more measurements (optional)
                <input 
                  type="text" 
                  id="measurement-search" 
                  placeholder="Search measurements..."
                  class="measurement-search"
                />
              </label>
              <div class="measurement-dropdown" id="measurement-dropdown">
                <!-- Will be populated by JavaScript -->
              </div>
            </div>

            <!-- Additional Fields Container -->
            <div class="field-group" id="additional-fields-group" style="display: none;">
              <h3 class="field-group-title">To improve accuracy, add more fields</h3>
              <div class="grid-form" id="additional-fields">
                <!-- Fields will be added here dynamically -->
              </div>
            </div>

            <div class="actions">
              <button type="reset" class="secondary">Clear</button>
              <button type="submit">Analyze Measurements</button>
            </div>
          </form>
        </article>

        <article class="card">
          <h2>Latest Analysis Result</h2>
          <div id="forms-output" class="forms-output"></div>
        </article>
      </section>
    </main>

    <footer>
      <small>For informational purposes only. Always consult a medical professional for diagnosis or treatment.</small>
    </footer>

    <script src="/assets/symptoms.js"></script>
    <script src="/assets/app.js"></script>
  </body>
</html>
